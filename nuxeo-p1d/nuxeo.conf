##=============================================================================
## Nuxeo configuration file       -    DEVELOPMENT ENVIRONNEMENT (VM osivia)
##=============================================================================
## See https://doc.nuxeo.com/x/PwA7 and https://doc.nuxeo.com/x/QQA7
## for detailed information about the settings below.

##-----------------------------------------------------------------------------
## Java
##-----------------------------------------------------------------------------
#JAVA_HOME=/usr/lib/jvm/java-7-sun
#JAVA_HOME=/Library/Java/JavaVirtualMachines/jdk1.7.0_71.jdk/Contents/Home

## Heap size
JAVA_OPTS=-Xms512m -Xmx1024m -XX:MaxPermSize=512m -server

## File encoding and encoded MIME parameters support
JAVA_OPTS=$JAVA_OPTS -Dfile.encoding=UTF-8 -Dmail.mime.decodeparameters=true

## Update sort behavior for Arrays and Collections may throw an IllegalArgumentException
JAVA_OPTS=$JAVA_OPTS -Djava.util.Arrays.useLegacyMergeSort=true

## Fix pour les connexions inter-VLAN : invalidation des connexions en idle dans les pools au bout de 5 minutes
JAVA_OPTS=$JAVA_OPTS -Dcom.sun.jndi.ldap.connect.pool.timeout=300000


## Log Garbage Collector informations into a file
#JAVA_OPTS=$JAVA_OPTS -Xloggc:"${nuxeo.log.dir}/gc.log" -verbose:gc -XX:+PrintGCDetails -XX:+PrintGCTimeStamps

##-----------------------------------------------------------------------------
## Nuxeo launcher
##-----------------------------------------------------------------------------
#launcher.start.max.wait=300
#launcher.stop.max.wait=60
#launcher.override.java.tmpdir=true

##-----------------------------------------------------------------------------
## Nuxeo filesystem paths
## ----------------------------------------------------------------------------
## Relative paths will be anchored at NUXEO_HOME; the following
##  are not default values but recommended values
nuxeo.log.dir=/var/log/nuxeo
#nuxeo.pid.dir=/var/run
nuxeo.data.dir=/data/nuxeo
#nuxeo.tmp.dir=/tmp

##-----------------------------------------------------------------------------
## General parameters
##-----------------------------------------------------------------------------
## Will regenerate config from these parameters each time the server
##  is restarted
nuxeo.force.generation=true
#nuxeo.templates=default
#nuxeo.bind.address=0.0.0.0
nuxeo.url=http://PUBLIC_HOST/nuxeo
nuxeo.server.http.port=8080
nuxeo.loopback.url=http://localhost:8080/nuxeo
nuxeo.server.tomcat_admin.port=8011
nuxeo.server.ajp.port=0
org.nuxeo.ecm.contextPath=/nuxeo
#org.nuxeo.ecm.product.name=
#org.nuxeo.ecm.product.version=

##-----------------------------------------------------------------------------
## Database configuration
##-----------------------------------------------------------------------------
#nuxeo.db.name=nuxeo-storage-qualif
#nuxeo.db.services.name=nuxeo-services-qualif
#nuxeo.db.user=nuxeo
#nuxeo.db.password=osivia
#nuxeo.db.host=ac-rennes-v3
#nuxeo.db.port=5432
#nuxeo.db.jdbc.url=
#nuxeo.db.driver=
## Pools
#nuxeo.db.min-pool-size=
#nuxeo.db.max-pool-size=
#nuxeo.vcs.min-pool-size=
#nuxeo.vcs.max-pool-size=100
## Database transaction timeout in seconds (tomcat only)
#nuxeo.db.transactiontimeout=300

##-----------------------------------------------------------------------------
## Elasticsearch configuration
##-----------------------------------------------------------------------------
## Enable or disable Elasticsearch integration, default is true.
elasticsearch.enabled=true
# Name of the Elasticsearch index for the default document repository
elasticsearch.indexName=nuxeo
# Comma separated list of Elasticsearch nodes, if empty use a local in JVM node
elasticsearch.addressList=ac-rennes-v3:9300
# Name of the Elasticsearch cluster to join
elasticsearch.clusterName=
# Number of replicas (not for local node)
elasticsearch.indexNumberOfReplicas=1
# Number of shards (not for local node)
elasticsearch.indexNumberOfShards=5
# Name of the local node
elasticsearch.nodeName=nuxeoNode
# Does the local node accept HTTP request on port 9200
elasticsearch.httpEnabled=false
# Load document model from Elasticsearch result (experimental)
# if false load from document from VCS
elasticsearch.fetchDocFromEs=false
#elasticsearch.fetchDocFromEs=true
# Comma separated list of CorePageProvider names to supersede by Elasticsearch
#elasticsearch.override.pageproviders=default_search
elasticsearch.override.pageproviders=default_search,GET_SIMILAR_SHORTNAME,GET_ACTIVE_PADS_FOR_SYNCHRONISATION,GET_TASKS_FOR_ACTORS,GET_TASKS_FOR_TARGET_DOCUMENT,GET_TASKS_FOR_TARGET_DOCUMENTS,GET_TASKS_FOR_TARGET_DOCUMENT_AND_ACTORS,GET_TASKS_FOR_TARGET_DOCUMENTS_AND_ACTORS,GET_TASKS_FOR_TARGET_DOCUMENTS_AND_ACTORS_OR_DELEGATED_ACTORS,GET_MEE_RESSOURCES_SUGGESTION,cv_ContentReadNWrite_NIPS,cv_clp_Content
# Reindexing option, number of documents to process per worker @since 6.0-HF03
elasticsearch.reindex.bucketReadSize=500
# Reindexing option, number of documents to submit to Elasticsearch per bulk command @since 6.0-HF03
elasticsearch.reindex.bucketWriteSize=100
#elasticsearch.reindex.bucketWriteSize=50
# Maximum size of the indexing thread pool @since 6.0-HF03
#elasticsearch.indexing.maxThreads=100
elasticsearch.indexing.maxThreads=16
# Time to keep the completed indexing worker states @since 6.0-HF03
elasticsearch.indexing.clearCompletedAfterSeconds=90

##==============================================
## Full Elasticsearch Mode
##==============================================

ottc.es.indexing.sync.force=true
ottc.querying.es.force=true

## Disable ACLs optimization:
nuxeo.vcs.optimizations.acl.enabled=false

##-----------------------------------------------------------------------------
## Various configuration
##-----------------------------------------------------------------------------
#toutatice.policy.wmoo.ignore=WriteModifyOwnOnly,validationWorkflow_validation

##==============================================
## PDF conversion
##==============================================

ottc.converter.toutaticeAny2pdf.poolSize=10

##========================
## Fulltext Analyzer
##========================
nuxeo.vcs.fulltext.search.analyzer=french

##========================
## Migrations
##========================

ottc.migration.facets.force=true
ottc.migration.ids.force=true
#ottc.migration.forums.force=true

#=== Slow queries ===
org.nuxeo.vcs.query.log_min_duration_ms=100


##-----------------------------------------------------------------------------
## Mail settings (for notifications)
##-----------------------------------------------------------------------------
#nuxeo.notification.eMailSubjectPrefix="[Nuxeo]"
#mail.transport.host=
#mail.transport.port=
#mail.transport.auth=
#mail.transport.username=
#mail.transport.password=
#mail.from=
#mailservice.user=
#mailservice.password=
#mail.store.protocol=
#mail.transport.protocol=
#mail.user=
#mail.pop3.host=
#mail.debug=

##-----------------------------------------------------------------------------
## LibreOffice server config
##-----------------------------------------------------------------------------
jod.connection.protocol=SOCKET
jod.max.tasks.per.process=200
jod.task.execution.timeout=30000
jod.task.queue.timeout=30000
jod.office.home=/usr/lib64/libreoffice
jod.jpipe.lib.path=/usr/lib64/ure/lib/
jod.template.profile.dir=

##-----------------------------------------------------------------------------
## OpenOffice / LibreOffice server config
##-----------------------------------------------------------------------------
#jod.connection.protocol=SOCKET
#jod.max.tasks.per.process=
#jod.task.execution.timeout=
#jod.task.queue.timeout=
#jod.office.home=/opt/ooo
#jod.jpipe.lib.path=
#jod.template.profile.dir=

##-----------------------------------------------------------------------------
## OpenSocial settings
##-----------------------------------------------------------------------------
#opensocial.gadgets.embeddedServer=
#opensocial.gadgets.host=
#opensocial.gadgets.port=
#opensocial.gadgets.path=
#opensocial.trusted.hosts=
## Encoding of the zip entries filename
#zip.entry.encoding=ascii

##-----------------------------------------------------------------------------
## Nuxeo Dev Mode
##-----------------------------------------------------------------------------
## Enable this mode if you'd like to benefit from hot reload features
##  useful for development. Setting this property to true will:
## - set the JSF facelets refresh period to 2s, enabling to check for
##   changes on JSF files
## - make it possible to hot-reload Studio jars from the admin center
## - reset different levels of caches when hot-reloading a Studio jar,
##   or when triggering the "Dev Mode > Force flush" action available
##   in user menu to administrators of the application
## The dev mode is disabled by default (not suitable for production)
##  and can also be activated from the Admin Center.
org.nuxeo.dev=true

##-----------------------------------------------------------------------------
## Nuxeo REST API
## -----------------------------------------------------------------------------
## Enable StackTrace display in JSON payload response in case of
## exception. By default there is no stacktrace displayed, only simple
## exception details.
#org.nuxeo.rest.stack.enable=true

##-----------------------------------------------------------------------------
## Nuxeo Automation Trace
##-----------------------------------------------------------------------------
## Enable this mode if you'd like to display automation traces during
##  runtime.  You'll benefit from exhaustive logs to debug all
##  automation chain and/or operation execution.
## The automation trace mode is disabled by default (not suitable for
##  production) and can also be activated through JMX via
##  org.nuxeo.automation:TracerFactory MBean during runtime.
#org.nuxeo.automation.trace=true

## By default, all automation executions are 'printable' (appear in
##  logs). You can filter chain and/or operation execution trace
##  printing by setting this property to chain name and/or operation
##  separated by comma. Comment it to get all back.
#org.nuxeo.automation.trace.printable=chainIdA,ChainIdB

##-----------------------------------------------------------------------------
## Nuxeo Routing - Clean up 'done' and 'canceled' workflow instances
##-----------------------------------------------------------------------------
## By default, completed workflow instances are removed. The clean-up
##  is triggered daily at midnight. (by a scheduler with the id
##  'workflowInstancesCleanup') If you want to keep these workflows
##  enable the following line:
#nuxeo.routing.disable.cleanup.workflow.instances=true

##-----------------------------------------------------------------------------
## LiveEdit auto-versioning will minor version if set to minor
##-----------------------------------------------------------------------------
#org.nuxeo.ecm.platform.liveedit.autoversioning=minor

##-----------------------------------------------------------------------------
## Clustering settings
##-----------------------------------------------------------------------------
#repository.clustering.enabled=false
#repository.clustering.delay=1000
## If clustering is activated, set
#repository.binary.store=/path/to/some/shared/folder/for/binaries

##-----------------------------------------------------------------------------
## Debugging options
##-----------------------------------------------------------------------------

## Sample JPDA settings for remote socket debugging
JAVA_OPTS=$JAVA_OPTS -Xdebug -Xrunjdwp:transport=dt_socket,address=8788,server=y,suspend=n

## Sample JPDA settings for shared memory debugging
#JAVA_OPTS=$JAVA_OPTS -Xdebug -Xnoagent -Djava.compiler=NONE -Xrunjdwp:transport=dt_shmem,server=y,suspend=n,address=jboss

## Enable jconsole
#JAVA_OPTS=$JAVA_OPTS -Dcom.sun.management.jmxremote=true

## Enable JMX
#JAVA_OPTS=$JAVA_OPTS -Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.port=1089 -Dcom.sun.management.jmxremote.ssl=false -Dcom.sun.management.jmxremote.authenticate=false

#metrics.csv.enabled=true
#metrics.csv.period=10
#metrics.csv.dir=${nuxeo.log.dir}
#metrics.graphite.enabled=true
#metrics.graphite.host=localhost
#metrics.graphite.port=2003
#metrics.graphite.period=10
#metrics.tomcat.enabled=true
#metrics.log4j.enabled=true
#org.nuxeo.vcs.query.log_min_duration_ms=500

## Disable soft references
#JAVA_OPTS=$JAVA_OPTS -XX:SoftRefLRUPolicyMSPerMB=0

## Mission control fligth recorder
#JAVA_OPTS=$JAVA_OPTS -Dcom.sun.management.jmxremote.autodiscovery=true -Dcom.sun.management.jdp.name=Nuxeo -XX:+UnlockCommercialFeatures -XX:+FlightRecorder
nuxeo.wizard.done=true
nuxeo.templates=postgresql,opentoutatice,osivia-migration,drive,opentoutatice-drive,opentoutatice,opentoutatice-es,opentoutatice-drive,opentoutatice-notification,acrennes,osivia-migration

##-----------------------------------------------------------------------------
## opentoutatice permalink
##-----------------------------------------------------------------------------
nuxeo.permalink.service.portal.url=http://PUBLIC_HOST
nuxeo.permalink.service.param1=portail
nuxeo.permalink.service.param2=cms

##-----------------------------------------------------------------------------
## via educ permalink
##-----------------------------------------------------------------------------
#nuxeo.unum.docviaeduc.host=http://www.viaeduc.fr
#nuxeo.unum.docviaeduc.param=group

##-----------------------------------------------------------------------------
## acrennes template - auth casshib
##-----------------------------------------------------------------------------
nuxeo.auth.secret.key=secretKey
nuxeo.auth.max.age=3600
nuxeo.auth.cas.appURL=http://PUBLIC_HOST/nuxeo
nuxeo.auth.cas.serviceLoginURL=https://CAS_PUBLIC_HOST/cas/login
nuxeo.auth.cas.serviceValidateURL=http://CAS_HOST/cas/serviceValidate
nuxeo.auth.cas.proxyValidateURL=http://CAS_HOST/cas/proxyValidate
nuxeo.auth.cas.serviceKey=service
nuxeo.auth.cas.logoutURL=https://CAS_PUBLIC_HOST/cas/logout

##-----------------------------------------------------------------------------
## Database configuration (single datasource mode)
##-----------------------------------------------------------------------------
nuxeo.db.host=ac-rennes-v3
nuxeo.db.name=nuxeo-storage-qualif
nuxeo.db.user=nuxeo
nuxeo.db.password=osivia
nuxeo.db.embeddedDatasources=true
nuxeo.db.xaMode=false
nuxeo.db.commonds=jdbc/nuxeo
#nuxeo.db.singleDataSource=jdbc/NuxeoDS
nuxeo.db.singleDataSource=
nuxeo.db.max-pool-size=105
nuxeo.vcs.max-pool-size=100

##-----------------------------------------------------------------------------
## LDAP
##-----------------------------------------------------------------------------

nuxeo.ldap.binddn=cn=Directory Manager
nuxeo.ldap.url=ldap\://LDAP_HOST\:1389
nuxeo.ldap.bindpassword=osivia

nuxeo.ldap.defaultAdministratorId=SuperAdministrator
nuxeo.ldap.user.mapping.company=rne
nuxeo.ldap.user.mapping.email=mail
nuxeo.ldap.user.mapping.firstname=givenName
nuxeo.ldap.user.mapping.lastname=sn
nuxeo.ldap.user.mapping.password=userPassword
nuxeo.ldap.user.mapping.rdn=uid
nuxeo.ldap.user.mapping.username=uid
nuxeo.ldap.user.searchBaseDn=ou=personnes,dc=ent-bretagne,dc=fr
nuxeo.ldap.user.searchClass=ENTPerson
nuxeo.ldap.user.searchScope=onelevel
nuxeo.ldap.user.searchBehavior=subinitial

nuxeo.ldap.group.mapping.members.staticAttributeId=member
nuxeo.ldap.group.mapping.name=cn
nuxeo.ldap.group.mapping.rdn=cn
#nuxeo.ldap.group.searchBaseDn=ou=groupes,dc=ent-bretagne,dc=fr
nuxeo.ldap.group.searchBaseDn=ou=profils,ou=groupes,dc=ent-bretagne,dc=fr
nuxeo.ldap.group.searchClass=ENTProfil
nuxeo.ldap.group.searchScope=onelevel
nuxeo.ldap.group.searchFilter=

nuxeo.ldap.group.profils.searchBaseDn=ou=profils,ou=groupes,dc=ent-bretagne,dc=fr
nuxeo.ldap.group.profils.searchClass=ENTProfil
nuxeo.ldap.group.profils.mapping.subGroups=subGroups
nuxeo.ldap.group.profils.searchScope=onelevel
nuxeo.ldap.group.profils.searchFilter=

nuxeo.ldap.group.roles.searchBaseDn=ou=RolesApplicatifs,ou=groupes,dc=ent-bretagne,dc=fr
nuxeo.ldap.group.roles.searchClass=ENTRoleAppli
nuxeo.ldap.group.roles.mapping.subGroups=ENTRoleAppliProfils
nuxeo.ldap.group.roles.searchScope=subtree
nuxeo.ldap.group.roles.searchFilter=

nuxeo.ldap.query.sizeLimit=1000
nuxeo.ldap.query.timeLimit=20000

##----------------------------------------------------------------------------
## Toutatpad
##----------------------------------------------------------------------------
#toutapad.publicServerURL=https://qt.toutatice.fr/pad
#toutapad.privateServerURL=localhost
#toutapad.prefixURL=/p/
#toutapad.apiKey=e86b9ca8441eabf65354c6accfc8f57f8eb7313dbcf453d105611124c60ecff2
#toutapad.welcomeMessage=&lt;html&gt;&lt;div&gt;Bienvenue sur ce nouveau PAD Toutatice.&lt;/div&gt;&lt;/html&gt;
#toutapad.synchronizationCron=0 0 5 * * ?

##-----------------------------------------------------------------------------
## TOUTAPAD
##-----------------------------------------------------------------------------
#acrennes.toutapad.serverURL=https://www.toutatice.fr/pad
#acrennes.toutapad.prefixURL=/p/
#acrennes.toutapad.apiKey=e86b9ca8441eabf65354c6accfc8f57f8eb7313dbcf453d105611124c60ecff2
#acrennes.toutapad.welcomeMessage=&lt;html&gt;&lt;div&gt;Bienvenue sur ce nouveau PAD Toutatice.&lt;/div&gt;&lt;/html&gt;
#acrennes.toutapad.synchronizationCron=0 0 5 * * ?
#acrennes.toutapad.contributionFormUrl=http://qt.toutatice.fr/toutatice-portail-cms-nuxeo/pad.jsp?urlpad=
#acrennes.toutapad.connectedView=false
acrennes.toutapad.serverURL=
acrennes.toutapad.prefixURL=/p/
acrennes.toutapad.apiKey=e86b9ca8441eabf65354c6accfc8f57f8eb7313dbcf453d105611124c60ecff2
acrennes.toutapad.welcomeMessage=&lt;html&gt;&lt;div&gt;Bienvenue sur ce nouveau PAD Toutatice.&lt;/div&gt;&lt;/html&gt;
acrennes.toutapad.synchronizationCron=0 0 5 * * ?
acrennes.toutapad.contributionFormUrl=
acrennes.toutapad.connectedView=false

##-------------------------
## JSF views states satck
##-------------------------
nuxeo.jsf.numberOfViewsInSession=20
nuxeo.jsf.numberOfLogicalViews=20

##-------------------------
## Forum migration property
## (Redmine ticket: #8766)
##-------------------------
#ottc.version=3.0.12


ottc.converter.toutaticeAny2pdf.poolSize=10


##-----------------------------------------------------------------------------
## ACRENNES
##-----------------------------------------------------------------------------
# enable remote debug
acrennes.server.tomcat.enableJmxRemoteLifecycleListener=false

# templates/acrennes/nxserver/config/acrennes-ldap-cache-config.xml.nxftl
nuxeo.ldap.cache.user.maxSize=1000
nuxeo.ldap.cache.user.withoutRef.maxSize=1000
nuxeo.ldap.cache.group.maxSize=1000
nuxeo.ldap.cache.group.withoutRef.maxSize=1000

#########################
# NUXEO

acrennes.nuxeo.auth.cas.enableTokenAuth=true
nuxeo.ldap.directory=groupLdapRolesDirectory

#avoid timeout on nuxeoCtl (https://jira.nuxeo.com/browse/NXP-7827)
org.nuxeo.connect.server.reachable=false

